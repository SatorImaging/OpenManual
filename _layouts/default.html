<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en-US' }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% seo %}

    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    <![endif]-->

    {% include head-custom.html %}

    {%- if false -%}
      <!-- jekyll commands are rendered as plain text in local environment so that remove those text from body and content element to achieve consistent layout in any environment. -->
      <script>
        document.addEventListener('DOMContentLoaded', (event) => {
          document.querySelectorAll('body,header,section').forEach((e) => {
            for(let node of e.childNodes.values()) {
              if(node.nodeType == Node.TEXT_NODE && -1 < node.textContent.search(/[^\s]+/)) {
                //alert(node.textContent);
                node.textContent = '';
              }
            }
          })
        });
      </script>
    {%- endif -%}

    <script src="https://code.jquery.com/jquery-3.3.0.min.js" integrity="sha256-RTQy8VOmNlT6b2PIRur37p6JEBZUE7o8wPgMvu18MC4=" crossorigin="anonymous"></script>
    <script>
      // https://github.com/pages-themes/leap-day/blob/master/assets/js/main.js
      // modified to support non-english characters.
      $(function() {
        if(-1 < document.querySelector('section').children[0].tagName.search(/[pP]/)) {
          let topAnchorEl = document.createElement('h2');
          topAnchorEl.innerText = '↑ Page Top';
          topAnchorEl.classList.add('d-none');
          document.querySelector('section').insertBefore(topAnchorEl, document.querySelector('section').children[0]);
        }
        $("section h1, section h2, section h3, section h4, section h5, section h6").each(function() {
          let anchorName = escape(this.innerText.toLowerCase().replace(/ /g, '-')).replace(/[^\w-]+/g,'');
          $("nav ul").append("<li class='tag-" + this.nodeName.toLowerCase() + "'><a href='#" + anchorName + "'>" + $(this).text() + "</a></li>");
          $(this).attr("id",anchorName);
          $("nav ul li:first-child a").parent().addClass("active");
          $("nav ul li:last-child").css("font-size", 'h1' == this.tagName.toLowerCase() ? "1.0em" : "0.825em");
        });
        $("nav ul li, section").on("click", "a", function(event) {
          let targetEl = $($(this).attr("href"));
          if(0 == targetEl.length) {
            let anchorId = '#'+escape($(this).attr("href").substr(1).toLowerCase().replace(/ /g, '-')).replace(/[^\w-]+/g,'');
            targetEl = $(anchorId);
          }
          var position = $(targetEl).offset().top - $("header").outerHeight(true) - 4; // magic number
          $("html, body").animate({scrollTop: position}, 400);
          $("nav ul li a").parent().removeClass("active");
          $(this).parent().addClass("active");
          event.preventDefault();
        });
      });
    </script>

    <!-- TODO: Bootstrap CDN update if required -->
    <link crossorigin='anonymous' rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T' />

    <!-- TODO: syntax hilighter stylesheet, pygments compatible -->
    <link crossorigin="anonymous" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pygments-css@1.0.0/github.css" integrity="sha256-63+ycHutvQKL4YAIsEEXm1MLug7+FbK/ZB1ufUWFfoc=" />

    <!-- TODO: Font Awesome CDN update if required -->
    <script crossorigin='anonymous' src='https://kit.fontawesome.com/a54fde8722.js'></script>

    <!-- TODO: flag icons css -->
    <link crossorigin="anonymous" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/4.1.5/css/flag-icons.min.css" integrity="sha512-UwbBNAFoECXUPeDhlKR3zzWU3j8ddKIQQsDOsKhXQGdiB5i3IHEXr9kXx82+gaHigbNKbTDp3VY/G6gZqva6ZQ==" />

    <!-- TODO: Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;300;600;900&display=swap" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@100;300;600;900&display=swap' rel='stylesheet' />


    <!-- stylesheet -->
    <style type='text/css'>
      body {
        font-weight: 300;
        font-family: 'Montserrat', 'M PLUS 1p', sans-serif;
      }
      section {
        position: relative;
      }


      header h1 {
        font-weight: 100;
        -font-family: 'M PLUS 1p', sans-serif;
      }

      .header--lang  a {
        text-decoration: none;
      }

      .spacer,
      nav ul li {
        list-style: none;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }



      .flag-icon
      {
        vertical-align: 0.075em;
        width: 1.375em;
      }
      .flag-icon-jp
      {
        border: 1px solid #e8e8e8;
      }

      section img { max-width: 100%; }
      section h1,
      section h2,
      section h3,
      section h4,
      section h5,
      section h6
      {
        max-width: 100%;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        font-weight: 600;
        color: #495057; /*#343a40;*/
        background: linear-gradient(transparent 70%, #cde7 70%);
        width: fit-content;
        margin-top: 2.0rem;
        margin-bottom: 1.6rem;
      }
      section *:first-child {
        margin-top: 0.0rem;
      }


      section .highlighter-rouge {
        border-radius: 0.25em;
        background-color: #ddd7;
      }
      section code.highlighter-rouge {
        display: inline-block;
        padding: 0em 0.4em;
      }
      section div.highlighter-rouge {
        padding: 0.5em 1.25em;
      }
      /* for Print to PDF */
      section pre { border: none; }


      blockquote {
        position: relative;
        border-radius: 0.25rem;
        padding: 1em 1.5em 0.1em 4em;
        margin-bottom: 1.5em;
        box-sizing: border-box;
        font-style: italic;
        background: #f0f4f8;
      }
      blockquote::before {
        display: inline-block;
        position: absolute;
        top: 0.25em;
        left: 0.45em;
        content: "\f10d";
        font-family: "FontAwesome";
        color: #d0d8e0;
        font-size: 2em;
        font-weight: 900;
      }
      blockquote p {
      }
      blockquote cite {
        display: block;
        text-align: right;
        color: #b0b4b8;
        font-size: 0.9em;
        margin-bottom: 0.5em;
      }


      :root {
          /* need offset: header + spacer in header */
          /* m-1/p-1: 0.25rem  2: 0.5rem  3: 1.0rem  4: 1.5rem  5: 3.0rem */
          --header-height: 8.5rem;
      }
      .header-spacer {
          margin-bottom: var(--header-height);
      }
      @media screen
      {
        .print--page-break::before {
          content: "------ 8< ------ PAGE BREAK FOR PDF ------ 8< ------";
          width: 100%;
          display: block;
          text-align: center;
          font-size: 0.5rem;
          color: #abc;
          border: 1px dashed #cde;
          border-width: 1px 0px;
          padding: 0.25rem 0px;
          margin-bottom: 1rem;
        }
        .screen--d-none { display: none; }
      }
      @media print
      {
        @page {
          margin: 0px;
        }
        .print--page-break::before {
          content: ""; /* empty string required */
          display: block;
          height: 6.0rem; /* wapper margin+padding + section margin+padding */
          margin-bottom: var(--header-height);
        }
        .print--page-break { break-before: page; }
        .print--hidden { visibility: hidden; }
        .print--d-none { display: none; }
      }
    </style>
  </head>
  <body>

    <!-- background fill need for PDF print -->
    <div id="background-fill" class="w-100 h-100 bg-light  position-fixed"></div>


    {%- if page.logo_src or site.logo_src -%}
      {%- assign logo_background = page.logo_background | default: site.logo_background | default: "#00cce4" -%}
      <div class="col-2 col-sm-2 col-md-2 col-lg-2   pl-0 pl-sm-0 pl-md-0   fixed-top   ml-auto"  style="z-index: 9999;">
        <a target="_blank" href='{{ page.logo_href | default: site.logo_href | default: "https://www.sator-imaging.com/" }}'>
          <div class="pt-3 pt-md-4  px-0  pb-2 pb-md-3   ml-0 ml-md-2 ml-lg-2" style='width: fit-content; border-radius: 0px 0px 5% 5%; overflow: hidden; background: {{ logo_background }};'>
            <img style='width: 12.5vw; max-width: 7rem;' src='{{ page.logo_src | default: site.logo_src }}' />
          </div>
        </a>
      </div>
      {%- if false -%}
        <script>
          let img = $("img")[$("img").length-1];
          img.src = 'https://avatars.githubusercontent.com/u/45192683';
          $(img).parent().css("background", "#00cce4");
        </script>
      {%- endif -%}
    {%- endif -%}
    <header class="bg-light   fixed-top   pt-5  mb-2   row no-gutters   -border-bottom">
      <!-- spacer same with toc -->
      <div class="col-0 col-sm-0 col-md-1 col-lg-2"></div>
      <div class="col-10 col-sm-10 col-md-9 col-lg-8   px-5 px-md-3 px-lg-4   -border">
        <h1 class="my-2   text-secondary  text-truncate   text-left">
          {{ page.title | default: site.title }}
        </h1>
        <p class="my-1    text-secondary  text-truncate  text-right">
          <span class="d-none  d-md-inline-block">
            <small class="screen--d-none">View Online:</small>
            <small class="print--d-none">Version:</small>
            <a href="{{ site.github.url }}{{ page.url }}">Latest</a>
            <script>
              // check url existance
              // https://stackoverflow.com/questions/333634/http-head-request-in-javascript-ajax
              function UrlExists(url, callback)
              {
                let http = new XMLHttpRequest();
                http.open('HEAD', url);
                http.onreadystatechange = function() {
                  if (this.readyState == this.DONE) {
                    callback(this.status != 404);
                  }
                };
                http.send();
              }
              // write links
              let testMode = location.protocol == 'file:';
              let surl = new URL(testMode ? 'https://satorimaging.github.io/OpenManual/index.en.html' : '{{ site.github.url }}{{ page.url }}');
              let slang = testMode ? 'en' : '{{ page.lang | default: site.lang | default: "en-US" }}';
              slang = slang.split('-')[0]; // no country code.
              for(let lang_country of ["en-US", "ja-JP", "zh-CN"])
              {
                let [tlang, tcountry] = lang_country.split('-');
                let turl = surl.protocol + '//' + surl.hostname.split('.').join('-') + '.translate.goog' + surl.pathname + '?_x_tr_sl=' + slang + '&_x_tr_tl=' + tlang;
                document.write('<span id="header--lang-'+tlang+'" class="print--d-none  header--lang">   <a href="'+turl+'"><span class="flag-icon flag-icon-'+tcountry.toLowerCase()+' -flag-icon-squared"></span></a></span>');
                // replace from google translate to github page
                let turl_github = surl.href.replace(/\.[^\/]+$/, '') + '.' + tlang + '.html'; // not .md
                UrlExists(turl_github, (isExists) => {
                  if(isExists) {
                    let rootEl = $('#header--lang-'+tlang);
                    $(rootEl).removeClass('print--d-none');  // show link in PDF.
                    $(rootEl).children('a')[0].url = turl_github;
                    $($(rootEl).children('a')[0]).append('<small> ' + tlang.toUpperCase() + '</small>');
                  }
                });
              }
            </script>
          </span>
          {%- if page.author -%}
            <span class="d-inline-block  ml-3">
              <small>written by</small>
              {% for author in page.author %}
                <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">{{ author }}</span>
                </span>
                {%- if forloop.last == false %}, {% endif -%}
              {% endfor %}
            </span>
          {%- endif -%}
          {%- if page.date -%}
            <span class="d-inline-block  ml-2">
              <small>On:</small>
              <time datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">
                {{ page.date | date: "%b %-d, %Y" }}
              </time>
            </span>
          {%- endif -%}
        </p>
      </div>
      <!-- spacer -->
      <div class="d-block d-md-none  w-100  my-3"></div>
      <div class="d-none d-md-block  w-100  my-3   pb-5  bg-light"></div>
    </header>


    <!-- spacer - keep same height with header + spacer in header -->
    <div class="header-spacer"></div>

    
    <div class="py-5   row no-gutters">
      <!-- spacer behind table of contents, need to place main section next to toc -->
      <div class="col-0 col-sm-0 col-md-1 col-lg-3"></div>
      <nav class="d-none d-lg-block  col-3   my-5  p-2  text-right  position-fixed  print--hidden">
        <ul></ul>
        <small>
          <a href="{{ site.github.url }}/">Browse</a>
          |
          Edit on <a href="https://github.dev/{{ site.github.repository_nwo }}">GitHub.dev</a>
        </small>
      </nav>
      <section class="col-12 col-sm-12 col-md-10 col-lg-7  px-5 px-md-3 px-lg-4   my-5 -border">
        {%- if page.url == '/' -%}
          <div id="page-links"></div>
          <script>
            function AddLink(dir, url, date, title, lang, snippet) {
              dir = dir.replace(/^\//, '').replace(/\/$/, '');
              dir = dir == "" ? "Miscellaneous" : dir;
              lang = lang.split('-')[0];
              let rootEl = document.querySelector('#page-links');
              let dirId = '#page-links--'+escape(dir.toLowerCase().replace(/ /g, '-')).replace(/[^\w-]+/g,'');
              let dirEl = document.querySelector(dirId);
              if(!dirEl) {
                let dirParentEl = document.createElement('div');
                rootEl.appendChild(dirParentEl);
                let dirLabel = document.createElement('h1');
                dirLabel.innerText = dir;
                dirParentEl.appendChild(dirLabel);
                dirEl = document.createElement('ul');
                dirEl.id = dirId;
                dirParentEl.appendChild(dirEl);
              }
              let linkEl = document.createElement('li');
              let country = {'en':'us','ja':'jp','zh':'cn'}[lang] ?? 'un';
              linkEl.innerHTML = '<a href="'+url+'">' + title + '</a>&nbsp;   <span class="flag-icon flag-icon-'+country+'"></span>   <small class="text-black-50">'+date+'</small><br /><small>' + snippet + '</small>';
              dirEl.appendChild(linkEl);
            }
          </script>
          {%- for page in site.pages -%}
            {%- if page.title -%}
              <script>
                AddLink('{{ page.dir }}',
                        '{{ site.github.url }}{{ page.url }}',
                        '{{ page.date | date: "%b-%d-%Y" }}',
                        '{{ page.title }}',
                        "{{ page.lang | default: site.lang | default: 'en-US' }}",
                        "{{ page.lang | default: site.lang | default: 'en-US' }}".split('-')[0] == 'en'
                          ? '{{ page.excerpt | default: page.content | strip_html | truncatewords: 20 }}'
                          : '{{ page.excerpt | default: page.content | strip_html | truncatewords: 3 }}'
                );
              </script>
            {%- endif -%}
          {% endfor %}
          <hr class="my-5" />
        {%- endif -%}
        {%- if false -%}
        <h1>Heading 1 : 見出し１</h1>
        <p>Test Body</p>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </p>
        <blockquote>
          <p>
            Here is blockquote.<br />
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
          </p>
          <p>Second Paragraph.</p>
          <cite>Cite from Wikipedia</cite>
        </blockquote>
        <p>Test Body</p>
        <p>Test Body</p>
        <p>
          Here is page break for print.
          <div class="print--page-break"></div>
        </p>
        <h2>Heading 2 : 見出し２</h2>
        <p>テスト本文</p>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </p>
        <p>
          <p>Rouge <code class="language-plaintext highlighter-rouge">inline-code</code></p>
          <div class="language-yaml highlighter-rouge"><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**</span>
<span class="cm"> * Does a thing</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">helloWorld</span><span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Do something</span>
  <span class="k">if</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="nx">something</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// @TODO comment</span>
<span class="p">}</span></code></pre></div></div>
        </p>
        <div class="print--page-break"></div>
        <p>
          The third page.
        </p>
        {%- endif -%}
        {{ content }}
        <!-- spacer for screen -->
        <div class="print--d-none  vh-100"></div>
      </section>
    </div>

    <footer class="bg-light  fixed-bottom  -row  text-secondary  -border-top  py-3">
      <p class="px-5  my-1  text-center  text-truncate">Copyright &copy; {{ site.time | date: "%Y" }} Sator Imaging, all rights reserved.</p>
      <p class="px-5  my-1  text-center  text-truncate  print--hidden">
        <small><a href="{{ site.github.repository_url }}">{{ site.github.repository_nwo }}</a> &mdash; {{ site.github.project_tagline }}</small>
      </p>
    </footer>

    <div class="print--hidden   fixed-bottom  text-right  px-2  small  text-black-50">
      <script>
        let res = {"Mobile":[576,1280],"Tablet":[768,1280],"Laptop":[1200,1200],"A4 Print set zoom to 75%":[678,1220]};//magicnumber = 678 * 1.8,"A4":[905,1280],"4x3":[1600,1200],"16x9":[1920,1080]
        for(let key in res) {
          document.write("<a href=\"javascript:window.open(location.href,'_blank','innerWidth="+res[key][0]+",innerHeight="+res[key][1]+",left="+Math.ceil((screen.width-res[key][0])*0.5)+"')\">"+key+"</a>");
          if(key != Object.keys(res)[Object.keys(res).length-1]) document.write(' | ');
        };
      </script>
      <!--
      <a href='javascript:$("body").css("overflow",$("body").css("overflow")!="hidden"?"hidden":"unset")'>Scrollbar</a>
      -->
    </div>

    <script src="{{ '/assets/js/scale.fix.js' | relative_url }}"></script>

  </body>
</html>
